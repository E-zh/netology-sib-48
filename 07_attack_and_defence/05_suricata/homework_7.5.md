# Специалист по информационной безопасности: специализация Pentest
## Модуль 7. Attack & Defence
### Желобанов Егор SIBDEF-48

# Домашнее задание к занятию «7.5. Мониторинг событий безопасности (Suricata)»

### Задание 1

Напишите правило для детектирования Xmas-сканирования.

### Ответ:

`alert tcp any any -> any any (msg:"Xmas scan detected!"; flags:FPU; flow:stateless; sid:1000001; rev:1; priority:3;)`

Параметры данного правила:

* `alert tcp any any -> any any` - анализируем весь TCP-трафик, от любого хоста к любому хосту, на любом порту.

* `flags:FPU;` - флаги TCP: FIN, PSH, URG - классическая сигнатура Xmas-пакета.

* `flow:stateless;` - указывает на то, что это правило не требует установленного соединения (важно для сканеров, которые не устанавливают полноценного соединения).

* `msg:"Xmas scan detected!";` - сообщение тревоги.

* `sid:1000001;` - уникальный идентификатор сигнатуры.

* `rev:1;` - версия правила.

* `priority:3;` - уровень важности (3 - низкий, можно повысить при необходимости).

------

### Задание 2

Напишите правило для детектирования стороннего трафика, передающегося службой DNS.

### Ответ:

`alert udp any any -> any 53 (msg:"External DNS traffic detected!"; content:!"|00 01|"; depth:2; dsize:>100; sid:1000002; rev:1; priority:2;)`

Параметры данного правила:

* `udp any any -> any 53` - правило анализирует весь UDP-трафик, направленный на порт 53 (стандартный порт DNS).

* `content:!"|00 01|"; depth:2;` - исключаем нормальные DNS-запросы типа A (0x00 0x01 в поле типа запроса), глубина 2 байта.

* `dsize:>100;` - подозрение вызывает аномально большой размер DNS-пакета (типично для DNS-туннелей).

* `msg:"External DNS traffic detected!";` - сообщение тревоги.

* `sid:1000002;` — уникальный ID правила.

* `rev:1;` - ревизия.

* `priority:2;` - средний приоритет (можно понизить - 3, или повысить - 1, при необходимости).

------

## Дополнительные задания со звёздочкой.

Эти задания необязательные. Их выполнение никак не влияет на получение зачёта по домашней работе. Вы можете их выполнить, если хотите усвоить полученный материал и лучше разобраться в теме.

------

### Задание 3*

Напишите правило для детектирования файлов или документов в сетевом трафике.

### Ответ:

Детектирование передачи PDF-файлов по HTTP:

`alert http any any -> any any (msg:"PDF file transfer detected over HTTP!"; file_data; content:"%PDF-"; depth:5; sid:1000004; rev:1; priority:2;)`

Параметры данного правила:

* `http any any -> any any` - правило анализирует HTTP-трафик.

* `file_data;` - переключение анализа на содержимое передаваемого файла.

* `content:"%PDF-"; depth:5;` — сигнатура начала PDF-файла (в первых 5 байтах).

* `msg:"PDF file transfer detected over HTTP!` - сообщение о срабатывании.

* `sid:1000004;` — уникальный ID правила.

* `rev:1;` - ревизия.

* `priority:2;` - средний приоритет (можно понизить - 3, или повысить - 1, при необходимости).
